import "pe"

rule file_scanning_capability {
    meta:
        author = "gr3yc4t"
        description = "Find portion of code responsible for scanning files on the target PC"
    strings:
        $firstFile = "FindFirstFile"
        $findNext = "FindNextFile"
    condition:
        all of them
}


rule get_windows_directory {
    meta:
        author = "gr3yc4t"
        description = "Check if the malware tries to get the path of a OS directory, check CSIDL here (https://tarma.com/support/im9/using/symbols/functions/csidls.htm)"
    strings:
        $callString = "SHGetFolderPath"
        $newcallString = "SHGetKnownFolderPath"
    condition:
        (
            $callString or $newcallString
        )
        or
        (
            pe.imports("shell32.dll", "SHGetFolderPathA")
            or
            pe.imports("shell32.dll", "SHGetKnownFolderPath ")
        )

}