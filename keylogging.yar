import "pe"
rule potential_keylogger {
	meta:
		author="gr3yc4t"
		description="Detect keylogging capability"
	condition:
		(
			pe.imports("User32.dll", "SetWindowsHookEx")
			and
			pe.imports("User32.dll", "RegisterHotKey")
		)
		and
		(
			pe.imports("User32.dll", "GetAsyncKeyState")
			and
			pe.imports("User32.dll", "GetForegroundWindow")
		)
}
